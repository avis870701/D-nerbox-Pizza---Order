<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>所有活動資料</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f1f1f1; /* 更換背景色 */
            margin: 0;
            padding: 20px;
        }

        h2 {
            text-align: center;
            color: #333;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        th, td {
            border: 1px solid #ddd; /* 更換欄位邊框顏色 */
            padding: 10px;
            text-align: center;
            background-color: #fff; /* 更換欄位背景色 */
        }

        th {
            background-color: #4CAF50; /* 更換標題背景色 */
            color: white; /* 更換標題文字顏色 */
        }

        a {
            text-decoration: none;
            color: blue;
        }

        a:hover {
            color: darkblue;
        }

        .btn {
            padding: 8px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
            text-decoration: none;
        }

        .btn:hover {
            background-color: #45a049;
        }

        .btn-danger {
            background-color: #f44336;
        }

        .btn-danger:hover {
            background-color: #cc0000;
        }

        img {
            width: 12vw;
            height: 12vw;
        }
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

</head>

<body>
<div align="center">
    <h2>所有活動資料</h2>
    <table>
        <thead>
        <tr>
            <th>活動編號</th>
            <th>活動名稱</th>
            <th>活動內容</th>
            <th>活動圖片</th>
            <th>活動折扣</th>
            <th>折扣碼</th>
            <th>開始日期</th>
            <th>結束日期</th>
            <th>修改</th>
            <th>刪除</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="promotions : ${promotions}">
            <td th:text="${promotions.promotions_id}"></td>
            <td><a th:href="@{/promotions/promotions/{id}(id=${promotions.promotions_id})}" th:text="${promotions.promotions_name}"></a></td>
            <td th:text="${promotions.promotions_content}"></td>
            <td><img th:src="${promotions.promotions_picture}" alt="無圖片"></td>
            <td th:text="${promotions.promotions_discount}"></td>
            <td th:text="${promotions.promotions_discountcode}"></td>
            <td th:text="${promotions.promotions_startdate}"></td>
            <td th:text="${promotions.promotions_enddate}"></td>
            <td><a class="btn" th:href="@{/promotions/promotions/update/{id}(id=${promotions.promotions_id})}">修改</a></td>
<!--            <td><a class="btn btn-danger" href="javascript:void(0);" th:onclick="'deletePromotions(\'' + ${promotions.promotions_name} + '\', \'' + ${promotions.promotions_id} + '\')'">刪除</a></td>-->
            <td>
                <a class="btn btn-danger" href="javascript:void(0);"
                   th:attr="data-promotions-name=${promotions.promotions_name},
                 data-promotions-id=${promotions.promotions_id}"
                   onclick="deletePromotions(this)" >
                    刪除
                </a>
            </td>



        </tr>
        </tbody>
    </table>
    <h3>
        共<span th:text="${promotions.size()}"></span>筆活動資料
    </h3>
    <p>
        <a class="btn" th:href="@{/promotions/promotions/insert}">新增活動</a>
        <a class="btn" th:href="@{/MemberGoBackToIndex}">回首頁</a>
    </p>
</div>

<script th:inline="javascript">
    // function deletePromotions(promotionsName, promotionsId) {
    //     var confirmDelete = confirm("確定要刪除活動 '" + promotionsName + "' 嗎？");
    //     if (confirmDelete) {
    //         $.ajax({
    //             url: "/promotions/promotions/delete/" + promotionsId,
    //             type: "DELETE",
    //             success: function (response) {
    //                 window.location.href = "/promotions/promotionsMain";
    //                 alert("活動已成功刪除！");
    //             },
    //             error: function (xhr, status, error) {
    //                 alert("刪除活動失敗：");
    //             }
    //         });
    //     }
    // }

    function deletePromotions(element) {
        var promotionsName = element.getAttribute('data-promotions-name');
        var promotionsId = element.getAttribute('data-promotions-id');

        var confirmDelete = confirm("確定要刪除活動 '" + promotionsName + "' 嗎？");
        if (confirmDelete) {
            $.ajax({
                url: "/promotions/promotions/delete/" + promotionsId,
                type: "DELETE",
                success: function (response) {
                    window.location.href = "/promotions/promotionsMain";
                    alert("活動已成功刪除！");
                },
                error: function (xhr, status, error) {
                    alert("刪除活動失敗：");
                }
            });
        }
    }

</script>

</body>

</html>
